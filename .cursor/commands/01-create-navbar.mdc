---
description: Navbar Komponente aus geklontem Relume Repo laden und konvertieren
---

# Schritt 1: Navbar erstellen

## Input
- Build Config: `.temp/build-config.json`

## Aufgaben

### 1. Navbar Code aus geklontem Repo laden

```bash
echo "üì• Lade Navbar Code..."

# Lade Build Config
BUILD_CONFIG=$(cat .temp/build-config.json)
NAVBAR_NAME=$(echo $BUILD_CONFIG | jq -r '.components.navbar.name')
NAVBAR_PATH=$(echo $BUILD_CONFIG | jq -r '.components.navbar.localPath')

# Check ob Datei existiert
if [ ! -f "$NAVBAR_PATH" ]; then
  echo "‚ùå Navbar nicht gefunden: $NAVBAR_PATH"
  exit 1
fi

# Kopiere f√ºr Analyse
mkdir -p .temp/relume-components/navbar
cp "$NAVBAR_PATH" ".temp/relume-components/navbar/${NAVBAR_NAME}.tsx"

echo "‚úÖ Navbar Code geladen: ${NAVBAR_NAME}"
echo "   Quelle: $NAVBAR_PATH"
```

### 2. Code analysieren

```typescript
const navbarName = JSON.parse(
  fs.readFileSync('.temp/build-config.json', 'utf-8')
).components.navbar.name;

const navbarCode = fs.readFileSync(
  `.temp/relume-components/navbar/${navbarName}.tsx`,
  'utf-8'
);

// Analysiere den Relume Code
const analysis = {
  name: navbarName,
  hasLogo: navbarCode.includes('logo') || navbarCode.includes('Logo'),
  hasNavLinks: navbarCode.includes('nav') || navbarCode.includes('menu'),
  hasCTA: navbarCode.includes('button') || navbarCode.includes('Button'),
  hasMobileMenu: navbarCode.includes('mobile') || navbarCode.includes('Mobile'),
  hasDropdown: navbarCode.includes('dropdown') || navbarCode.includes('submenu'),
  buttonCount: (navbarCode.match(/button/gi) || []).length,
  hasUseState: navbarCode.includes('useState'),
  tailwindClasses: {
    found: true,
    mobile: navbarCode.includes('lg:hidden') || navbarCode.includes('md:hidden'),
    desktop: navbarCode.includes('hidden lg:') || navbarCode.includes('hidden md:'),
  }
};

fs.writeFileSync(
  '.temp/analysis/navbar-analysis.json',
  JSON.stringify(analysis, null, 2)
);

console.log('‚úÖ Code Analyse abgeschlossen');
console.log(JSON.stringify(analysis, null, 2));
```

### 3. MobileNav.tsx erstellen

```typescript
// filepath: src/Header/MobileNav.tsx
'use client'

import React, { useState } from 'react'
import type { Header } from '@/payload-types'
import { Button } from '@/components/ui/button'
import { Media } from '@/components/Media'
import { CMSLink } from '@/components/CMSLink'
import { Menu, X } from 'lucide-react'

interface MobileNavProps {
  header: Header
}

export const MobileNav: React.FC<MobileNavProps> = ({ header }) => {
  const [isOpen, setIsOpen] = useState(false)
  
  return (
    <div className="lg:hidden">
      <div className="flex items-center justify-between px-[5%] py-4">
        {header.logo && (
          <Media 
            resource={header.logo} 
            className="h-8 w-auto"
          />
        )}
        
        <Button
          variant="ghost"
          size="icon"
          onClick={() => setIsOpen(!isOpen)}
          aria-label="Menu"
        >
          {isOpen ? <X className="h-6 w-6" /> : <Menu className="h-6 w-6" />}
        </Button>
      </div>
      
      {isOpen && (
        <div className="px-[5%] pb-4">
          <nav className="flex flex-col space-y-4">
            {header.navigation?.map((item, index) => (
              <CMSLink
                key={index}
                {...item.link}
                className="text-md"
                onClick={() => setIsOpen(false)}
              >
                {item.label}
              </CMSLink>
            ))}
          </nav>
          
          {header.ctaButton && (
            <div className="mt-6">
              <Button
                variant={header.ctaButton.variant || 'default'}
                className="w-full"
                asChild
              >
                <CMSLink {...header.ctaButton.link}>
                  {header.ctaButton.text}
                </CMSLink>
              </Button>
            </div>
          )}
        </div>
      )}
    </div>
  )
}
```

### 4. DesktopNav.tsx erstellen

```typescript
// filepath: src/Header/DesktopNav.tsx
'use client'

import React from 'react'
import type { Header } from '@/payload-types'
import { Button } from '@/components/ui/button'
import { Media } from '@/components/Media'
import { CMSLink } from '@/components/CMSLink'

interface DesktopNavProps {
  header: Header
}

export const DesktopNav: React.FC<DesktopNavProps> = ({ header }) => {
  return (
    <div className="hidden lg:block">
      <div className="flex items-center justify-between px-[5%] py-4">
        {header.logo && (
          <Media 
            resource={header.logo} 
            className="h-8 w-auto"
          />
        )}
        
        <nav className="flex items-center gap-6">
          {header.navigation?.map((item, index) => (
            <CMSLink
              key={index}
              {...item.link}
              className="text-sm font-medium transition-colors hover:text-primary"
            >
              {item.label}
            </CMSLink>
          ))}
        </nav>
        
        {header.ctaButton && (
          <Button
            variant={header.ctaButton.variant || 'default'}
            asChild
          >
            <CMSLink {...header.ctaButton.link}>
              {header.ctaButton.text}
            </CMSLink>
          </Button>
        )}
      </div>
    </div>
  )
}
```

### 5. PayloadCMS Config

```typescript
// filepath: src/Header/config.ts
import type { GlobalConfig } from 'payload'
import { revalidateHeader } from './hooks/revalidateHeader'

export const Header: GlobalConfig = {
  slug: 'header',
  label: 'Kopfzeile',
  fields: [
    {
      name: 'logo',
      type: 'upload',
      relationTo: 'media',
      label: 'Logo',
      required: true,
      admin: {
        description: 'Das Haupt-Logo der Website',
      },
    },
    {
      name: 'navigation',
      type: 'array',
      label: 'Hauptnavigation',
      minRows: 1,
      maxRows: 8,
      fields: [
        {
          name: 'label',
          type: 'text',
          label: 'Beschriftung',
          required: true,
        },
        {
          name: 'link',
          type: 'group',
          label: 'Link',
          fields: [
            {
              name: 'type',
              type: 'select',
              label: 'Link-Typ',
              options: [
                { label: 'Interne Seite', value: 'page' },
                { label: 'Externe URL', value: 'url' },
              ],
              defaultValue: 'page',
            },
            {
              name: 'page',
              type: 'relationship',
              relationTo: 'pages',
              label: 'Seite',
              admin: {
                condition: (data, siblingData) => siblingData?.type === 'page',
              },
            },
            {
              name: 'url',
              type: 'text',
              label: 'URL',
              admin: {
                condition: (data, siblingData) => siblingData?.type === 'url',
              },
            },
          ],
        },
      ],
    },
    {
      name: 'ctaButton',
      type: 'group',
      label: 'CTA Button',
      fields: [
        {
          name: 'text',
          type: 'text',
          label: 'Button Text',
          defaultValue: 'Kontakt',
        },
        {
          name: 'link',
          type: 'group',
          label: 'Link',
          fields: [
            {
              name: 'type',
              type: 'select',
              options: [
                { label: 'Interne Seite', value: 'page' },
                { label: 'Externe URL', value: 'url' },
              ],
            },
            {
              name: 'page',
              type: 'relationship',
              relationTo: 'pages',
              admin: {
                condition: (_, siblingData) => siblingData?.type === 'page',
              },
            },
            {
              name: 'url',
              type: 'text',
              admin: {
                condition: (_, siblingData) => siblingData?.type === 'url',
              },
            },
          ],
        },
        {
          name: 'variant',
          type: 'select',
          label: 'Button Stil',
          admin: {
            description: 'W√§hle den Stil des Buttons (ShadCN Variant)',
          },
          options: [
            { label: 'Standard (gef√ºllt)', value: 'default' },
            { label: 'Outline', value: 'outline' },
            { label: 'Ghost (transparent)', value: 'ghost' },
            { label: 'Link', value: 'link' },
          ],
          defaultValue: 'default',
        },
      ],
    },
  ],
  hooks: {
    afterChange: [revalidateHeader],
  },
}
```

### 6. Hook erstellen

```bash
mkdir -p src/Header/hooks
```

```typescript
// filepath: src/Header/hooks/revalidateHeader.ts
import type { GlobalAfterChangeHook } from 'payload'
import { revalidateTag } from 'next/cache'

export const revalidateHeader: GlobalAfterChangeHook = ({ 
  doc, 
  req: { payload, context } 
}) => {
  if (!context.disableRevalidate) {
    payload.logger.info(`Revalidating header`)
    revalidateTag('global_header')
  }
  return doc
}
```

### 7. Index Export

```typescript
// filepath: src/Header/index.tsx
'use client'

import { MobileNav } from './MobileNav'
import { DesktopNav } from './DesktopNav'
import type { Header as HeaderType } from '@/payload-types'

interface HeaderProps {
  header: HeaderType
}

export const Header: React.FC<HeaderProps> = ({ header }) => {
  return (
    <header>
      <MobileNav header={header} />
      <DesktopNav header={header} />
    </header>
  )
}
```

### 8. Migration erstellen

```bash
echo "üìù Erstelle Migration f√ºr Header..."
npm run payload migrate:create -- --name add-header-global

echo "üîÑ F√ºhre Migration aus..."
npm run payload migrate

if [ $? -eq 0 ]; then
  echo "‚úÖ Migration erfolgreich ausgef√ºhrt"
else
  echo "‚ùå Migration fehlgeschlagen"
  exit 1
fi
```

### 9. In payload.config.ts registrieren

```typescript
// filepath: src/payload.config.ts
// ...existing code...
import { Header } from './Header/config'

export default buildConfig({
  // ...existing code...
  globals: [
    Header,
    // ...existing code...
  ],
})
```

### 10. Git Commit

```bash
NAVBAR_NAME=$(cat .temp/build-config.json | jq -r '.components.navbar.name')

git add src/Header/
git add src/payload.config.ts
git add src/migrations/

git commit -m "feat(header): add ${NAVBAR_NAME} navbar

Source: ${NAVBAR_NAME}.tsx from cloned Relume repo
Components:
- MobileNav.tsx (responsive mobile menu)
- DesktopNav.tsx (desktop navigation)
- config.ts with German UX labels
- revalidateHeader hook for cache invalidation
- index.tsx export

Features:
‚úÖ Original Relume design preserved
‚úÖ All Tailwind classes maintained
‚úÖ ShadCN Button variants (default, outline, ghost, link)
‚úÖ Lucide icons for menu toggle
‚úÖ Responsive breakpoints (lg:hidden/hidden lg:)
‚úÖ German PayloadCMS labels
‚úÖ Migration executed successfully
‚úÖ Registered in payload.config.ts

No custom styles - pure ShadCN components!"

echo "‚úÖ Git Commit erstellt"
```

## Erfolgskriterien

- [ ] Navbar Code erfolgreich aus `.temp/relume-repo/` geladen
- [ ] Code Analyse durchgef√ºhrt und gespeichert
- [ ] MobileNav.tsx erstellt mit Relume Design
- [ ] DesktopNav.tsx erstellt mit Relume Design
- [ ] config.ts mit deutschen Labels und ShadCN variants
- [ ] Nur ShadCN Button Variants verwendet (keine Custom-Styles!)
- [ ] revalidateHeader Hook vorhanden
- [ ] Migration erfolgreich ausgef√ºhrt
- [ ] In payload.config.ts registriert
- [ ] Git Commit erstellt
- [ ] Alle Tailwind Classes exakt beibehalten

## N√§chster Schritt
`.cursor/commands/02-create-footer.mdc`