---
description: Projekt-Initialisierung mit Git Clone und Validierung
---

# Schritt 0: Projekt initialisieren

## Aufgaben

### 1. Relume Repository klonen

```bash
echo "üì• Klone Relume Repository..."

# Lade Relume Struktur Config
RELUME_CONFIG=$(cat .cursor/relume-structure.json)
REPO_URL=$(echo $RELUME_CONFIG | jq -r '.repository.url')
REPO_BRANCH=$(echo $RELUME_CONFIG | jq -r '.repository.branch')
LOCAL_PATH=$(echo $RELUME_CONFIG | jq -r '.repository.localPath')

# Erstelle Temp Verzeichnis
mkdir -p .temp

# Clone Repository (shallow clone f√ºr Performance)
if [ -d "$LOCAL_PATH" ]; then
  echo "Repository existiert bereits, pull latest..."
  cd $LOCAL_PATH
  git pull origin $REPO_BRANCH
  cd -
else
  echo "Clone Repository..."
  git clone --depth 1 --branch $REPO_BRANCH $REPO_URL $LOCAL_PATH
fi

echo "‚úÖ Relume Repository geklont nach $LOCAL_PATH"
```

### 2. Repository Struktur validieren

```bash
echo "üîç Validiere Repository Struktur..."

# Check ob relume Ordner existiert
if [ ! -d "$LOCAL_PATH/relume" ]; then
  echo "‚ùå relume/ Ordner nicht gefunden in Repository"
  exit 1
fi

# Check wichtige Kategorien
for category in "Header" "Footer" "CTA" "FAQ" "Contact"; do
  if [ ! -d "$LOCAL_PATH/relume/$category" ]; then
    echo "‚ùå Kategorie $category nicht gefunden"
    exit 1
  fi
  echo "‚úÖ Kategorie $category gefunden"
done

echo "‚úÖ Repository Struktur validiert"
```

### 3. Projekt validieren

```bash
echo "üîç Validiere Projekt Setup..."

# Check wichtige Dateien
FILES_TO_CHECK=(
  "payload.config.ts"
  "package.json"
  "tsconfig.json"
  "components/ui/button.tsx"
)

for file in "${FILES_TO_CHECK[@]}"; do
  if [ ! -f "$file" ]; then
    echo "‚ùå Datei fehlt: $file"
    exit 1
  fi
  echo "‚úÖ $file vorhanden"
done

# Check Dependencies
echo "üì¶ Checke Dependencies..."
REQUIRED_DEPS=("payload" "@payloadcms/richtext-lexical" "next" "react")

for dep in "${REQUIRED_DEPS[@]}"; do
  if ! grep -q "\"$dep\"" package.json; then
    echo "‚ùå Dependency fehlt: $dep"
    exit 1
  fi
done

echo "‚úÖ Alle Dependencies vorhanden"
```

### 4. Git Branch erstellen

```bash
# Feature Branch mit Timestamp
TIMESTAMP=$(date +%Y%m%d-%H%M%S)
BRANCH_NAME="feature/website-generation-${TIMESTAMP}"

git checkout -b ${BRANCH_NAME}
echo "‚úÖ Branch erstellt: ${BRANCH_NAME}"

# Branch Name f√ºr sp√§teren Zugriff speichern
echo $BRANCH_NAME > .temp/current-branch.txt
```

### 5. Arbeitsverzeichnis vorbereiten

```bash
# Temp Ordner f√ºr verschiedene Zwecke
mkdir -p .temp/relume-components/navbar
mkdir -p .temp/relume-components/footer
mkdir -p .temp/relume-components/heroes
mkdir -p .temp/relume-components/blocks
mkdir -p .temp/migration-logs
mkdir -p .temp/analysis

echo "‚úÖ Arbeitsverzeichnisse erstellt"
```

### 6. Props validieren

```typescript
// Validiere Input Props
interface BuildProps {
  navbar: string;
  footer: string;
  heroes: string[];
  blocks: string[];
}

function validateProps(props: BuildProps): void {
  const relumeStructure = JSON.parse(
    fs.readFileSync('.cursor/relume-structure.json', 'utf-8')
  );
  
  // Navbar validieren
  if (!props.navbar || typeof props.navbar !== 'string') {
    throw new Error('navbar prop erforderlich und muss string sein');
  }
  const navbarExists = relumeStructure.structure.categories.Header.components.navbars
    .includes(props.navbar);
  if (!navbarExists) {
    console.warn(`‚ö†Ô∏è  Navbar "${props.navbar}" nicht in relume-structure.json gefunden`);
  }
  
  // Footer validieren
  if (!props.footer || typeof props.footer !== 'string') {
    throw new Error('footer prop erforderlich und muss string sein');
  }
  const footerExists = relumeStructure.structure.categories.Footer.components
    .includes(props.footer);
  if (!footerExists) {
    console.warn(`‚ö†Ô∏è  Footer "${props.footer}" nicht in relume-structure.json gefunden`);
  }
  
  // Heroes validieren
  if (!Array.isArray(props.heroes) || props.heroes.length === 0) {
    throw new Error('heroes prop muss Array mit mindestens 1 Hero sein');
  }
  
  // Blocks validieren
  if (!Array.isArray(props.blocks) || props.blocks.length === 0) {
    throw new Error('blocks prop muss Array mit mindestens 1 Block sein');
  }
  
  console.log('‚úÖ Props validiert');
}

validateProps(props);
```

### 7. Props normalisieren und Build Config erstellen

```typescript
const relumeStructure = JSON.parse(
  fs.readFileSync('.cursor/relume-structure.json', 'utf-8')
);

const localRepoPath = relumeStructure.repository.localPath;
const branchName = fs.readFileSync('.temp/current-branch.txt', 'utf-8').trim();

// Normalisiere Hero Namen (Header1 -> HeroHeader1)
const normalizedHeroes = props.heroes.map(hero => {
  if (hero.startsWith('HeroHeader')) {
    return hero;
  }
  return hero.replace(/^Header/, 'HeroHeader');
});

// Erstelle Build Config
const buildConfig = {
  timestamp: new Date().toISOString(),
  branch: branchName,
  relume: {
    localPath: localRepoPath,
    basePath: relumeStructure.structure.basePath,
  },
  components: {
    navbar: {
      name: props.navbar,
      localPath: `${localRepoPath}/relume/Header/${props.navbar}.tsx`,
      targetPath: 'src/Header'
    },
    footer: {
      name: props.footer,
      localPath: `${localRepoPath}/relume/Footer/${props.footer}.tsx`,
      targetPath: 'src/Footer'
    },
    heroes: normalizedHeroes.map((hero, index) => ({
      name: hero,
      originalName: props.heroes[index],
      localPath: `${localRepoPath}/relume/Header/${hero}.tsx`,
      targetPath: `src/heroes/${hero}`
    })),
    blocks: props.blocks.map(block => {
      const category = determineCategory(block, relumeStructure);
      return {
        name: block,
        category,
        localPath: `${localRepoPath}/relume/${category}/${block}.tsx`,
        targetPath: `src/blocks/${category}/${block}`
      };
    })
  }
};

// Speichern
fs.writeFileSync(
  '.temp/build-config.json',
  JSON.stringify(buildConfig, null, 2)
);

console.log('‚úÖ Build Config gespeichert in .temp/build-config.json');
console.log('\nBuild Config:');
console.log(JSON.stringify(buildConfig, null, 2));
```

### 8. Category Detection Funktion

```typescript
function determineCategory(
  blockName: string, 
  relumeStructure: any
): string {
  // Extract prefix from block name
  const match = blockName.match(/^([A-Z][a-z]*[A-Z]*)/);
  const prefix = match ? match[1] : blockName;
  
  // Mapping zu Relume Ordnernamen
  const categoryMap: Record<string, string> = {
    'Banner': 'Banners',
    'Blog': 'Blog',
    'BlogPost': 'BlogPostHeader',
    'Career': 'Career',
    'Comparison': 'Comparison',
    'Contact': 'Contact',
    'ContactModal': 'ContactModal',
    'CTA': 'CTA',
    'Event': 'Events',
    'EventHeader': 'EventHeaders',
    'EventHeaderItem': 'EventHeaderItems',
    'FAQ': 'FAQ',
    'Gallery': 'Gallery',
  };
  
  const category = categoryMap[prefix] || prefix;
  
  // Validiere dass Kategorie existiert
  if (!relumeStructure.structure.categories[category]) {
    console.warn(`‚ö†Ô∏è  Kategorie "${category}" f√ºr Block "${blockName}" nicht gefunden`);
  }
  
  return category;
}
```

### 9. Komponenten-Existenz pr√ºfen

```bash
echo "üîç Pr√ºfe Existenz aller Komponenten..."

# Lade Build Config
BUILD_CONFIG=$(cat .temp/build-config.json)

# Check Navbar
NAVBAR_PATH=$(echo $BUILD_CONFIG | jq -r '.components.navbar.localPath')
if [ ! -f "$NAVBAR_PATH" ]; then
  echo "‚ùå Navbar nicht gefunden: $NAVBAR_PATH"
  exit 1
fi
echo "‚úÖ Navbar gefunden: $(echo $BUILD_CONFIG | jq -r '.components.navbar.name')"

# Check Footer
FOOTER_PATH=$(echo $BUILD_CONFIG | jq -r '.components.footer.localPath')
if [ ! -f "$FOOTER_PATH" ]; then
  echo "‚ùå Footer nicht gefunden: $FOOTER_PATH"
  exit 1
fi
echo "‚úÖ Footer gefunden: $(echo $BUILD_CONFIG | jq -r '.components.footer.name')"

# Check Heroes
HERO_COUNT=$(echo $BUILD_CONFIG | jq '.components.heroes | length')
for i in $(seq 0 $(($HERO_COUNT - 1))); do
  HERO_PATH=$(echo $BUILD_CONFIG | jq -r ".components.heroes[$i].localPath")
  HERO_NAME=$(echo $BUILD_CONFIG | jq -r ".components.heroes[$i].name")
  
  if [ ! -f "$HERO_PATH" ]; then
    echo "‚ùå Hero nicht gefunden: $HERO_NAME ($HERO_PATH)"
    exit 1
  fi
  echo "‚úÖ Hero gefunden: $HERO_NAME"
done

# Check Blocks
BLOCK_COUNT=$(echo $BUILD_CONFIG | jq '.components.blocks | length')
for i in $(seq 0 $(($BLOCK_COUNT - 1))); do
  BLOCK_PATH=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].localPath")
  BLOCK_NAME=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].name")
  
  if [ ! -f "$BLOCK_PATH" ]; then
    echo "‚ùå Block nicht gefunden: $BLOCK_NAME ($BLOCK_PATH)"
    exit 1
  fi
  echo "‚úÖ Block gefunden: $BLOCK_NAME"
done

echo "‚úÖ Alle Komponenten existieren im geklonten Repository"
```

### 10. Initialer Git Commit

```bash
git add .temp/
git add .cursor/relume-structure.json

git commit -m "chore: initialize website generation

Build Config:
- Navbar: $(echo $BUILD_CONFIG | jq -r '.components.navbar.name')
- Footer: $(echo $BUILD_CONFIG | jq -r '.components.footer.name')
- Heroes: $(echo $BUILD_CONFIG | jq -r '.components.heroes[].originalName' | tr '\n' ', ')
- Blocks: $(echo $BUILD_CONFIG | jq -r '.components.blocks[].name' | tr '\n' ', ')

Branch: $BRANCH_NAME
Timestamp: $(date -Iseconds)
Relume Repo: $LOCAL_PATH"

echo "‚úÖ Initialer Commit erstellt"
```

## Erfolgskriterien

- [ ] Relume Repository erfolgreich geklont
- [ ] Repository Struktur validiert
- [ ] Git Branch erstellt
- [ ] Alle Verzeichnisse existieren
- [ ] Props validiert und normalisiert
- [ ] Build Config gespeichert
- [ ] Alle Komponenten gefunden
- [ ] Category Detection funktioniert
- [ ] Initialer Commit erstellt
- [ ] Bereit f√ºr n√§chsten Schritt

## Output

Nach erfolgreicher Initialisierung:

```
üì• Klone Relume Repository...
‚úÖ Relume Repository geklont nach .temp/relume-repo
üîç Validiere Repository Struktur...
‚úÖ Kategorie Header gefunden
‚úÖ Kategorie Footer gefunden
‚úÖ Kategorie CTA gefunden
‚úÖ Kategorie FAQ gefunden
‚úÖ Kategorie Contact gefunden
‚úÖ Repository Struktur validiert
üîç Validiere Projekt Setup...
‚úÖ payload.config.ts vorhanden
‚úÖ package.json vorhanden
‚úÖ tsconfig.json vorhanden
‚úÖ components/ui/button.tsx vorhanden
‚úÖ Alle Dependencies vorhanden
‚úÖ Branch erstellt: feature/website-generation-20231017-143022
‚úÖ Arbeitsverzeichnisse erstellt
‚úÖ Props validiert
‚úÖ Build Config gespeichert in .temp/build-config.json
üîç Pr√ºfe Existenz aller Komponenten...
‚úÖ Navbar gefunden: Navbar1
‚úÖ Footer gefunden: Footer1
‚úÖ Hero gefunden: HeroHeader1
‚úÖ Hero gefunden: HeroHeader2
‚úÖ Block gefunden: CTA2
‚úÖ Block gefunden: FAQ5
‚úÖ Alle Komponenten existieren im geklonten Repository
‚úÖ Initialer Commit erstellt

N√§chster Schritt: 01-create-navbar.mdc
```

## N√§chster Schritt
`.cursor/commands/01-create-navbar.mdc`