---
description: Alle Block Komponenten aus geklontem Relume Repo laden und konvertieren
---

# Schritt 4: Blocks erstellen

## Input
- Build Config: `.temp/build-config.json`

## Relume Repository Struktur

Blocks sind in Kategorien organisiert:
- `relume/Banners/` - Banner Komponenten
- `relume/Blog/` - Blog Komponenten
- `relume/CTA/` - Call-to-Action Komponenten
- `relume/FAQ/` - FAQ Komponenten
- `relume/Contact/` - Kontakt Komponenten
- `relume/Gallery/` - Galerie Komponenten
- etc.

## Aufgaben

### 1. Alle Block Komponenten aus geklontem Repo laden

```bash
echo "üì• Lade Block Komponenten..."

BUILD_CONFIG=$(cat .temp/build-config.json)
BLOCK_COUNT=$(echo $BUILD_CONFIG | jq '.components.blocks | length')

mkdir -p .temp/relume-components/blocks

echo "Lade $BLOCK_COUNT Blocks..."

for i in $(seq 0 $(($BLOCK_COUNT - 1))); do
  BLOCK_NAME=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].name")
  BLOCK_CATEGORY=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].category")
  BLOCK_PATH=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].localPath")
  
  if [ ! -f "$BLOCK_PATH" ]; then
    echo "‚ùå Block nicht gefunden: $BLOCK_NAME ($BLOCK_PATH)"
    exit 1
  fi
  
  mkdir -p ".temp/relume-components/blocks/${BLOCK_CATEGORY}"
  cp "$BLOCK_PATH" ".temp/relume-components/blocks/${BLOCK_CATEGORY}/${BLOCK_NAME}.tsx"
  echo "‚úÖ Geladen: $BLOCK_NAME ($BLOCK_CATEGORY)"
done

echo "‚úÖ Alle $BLOCK_COUNT Blocks geladen"
```

### 2. Alle Blocks analysieren

```typescript
const buildConfig = JSON.parse(
  fs.readFileSync('.temp/build-config.json', 'utf-8')
);

const blockAnalysis = [];

for (const block of buildConfig.components.blocks) {
  const blockCode = fs.readFileSync(
    `.temp/relume-components/blocks/${block.category}/${block.name}.tsx`,
    'utf-8'
  );
  
  const analysis = {
    name: block.name,
    category: block.category,
    hasHeading: blockCode.includes('heading') || blockCode.includes('Heading'),
    hasDescription: blockCode.includes('description') || blockCode.includes('Description'),
    hasImage: blockCode.includes('img') || blockCode.includes('Image'),
    hasRichText: blockCode.includes('richText') || blockCode.includes('content'),
    hasButtons: blockCode.includes('button') || blockCode.includes('Button'),
    hasForm: blockCode.includes('form') || blockCode.includes('Form') || blockCode.includes('input'),
    hasGrid: blockCode.includes('grid') || blockCode.includes('Grid'),
    hasCards: blockCode.includes('card') || blockCode.includes('Card'),
    hasTestimonials: blockCode.includes('testimonial') || blockCode.includes('quote'),
    hasFAQ: blockCode.includes('faq') || blockCode.includes('accordion'),
    buttonCount: (blockCode.match(/button|Button/gi) || []).length,
  };
  
  blockAnalysis.push(analysis);
  console.log(`‚úÖ Analysiert: ${block.name} (${block.category})`);
}

fs.writeFileSync(
  '.temp/analysis/blocks-analysis.json',
  JSON.stringify(blockAnalysis, null, 2)
);

console.log(`‚úÖ Alle ${blockAnalysis.length} Blocks analysiert`);
```

### 3. Block Configs erstellen

F√ºr jeden Block eine Config:

```typescript
// filepath: src/blocks/{Category}/{BlockName}/config.ts
import type { Block } from 'payload'

export const {BlockName}Block: Block = {
  slug: '{blockSlug}', // z.B. 'cta2', 'faq5', 'contact1'
  labels: {
    singular: '{Block Label}',
    plural: '{Block Label Plural}',
  },
  fields: [
    {
      name: 'heading',
      type: 'text',
      label: '√úberschrift',
      admin: {
        description: 'Haupt√ºberschrift des Blocks',
      },
    },
    {
      name: 'description',
      type: 'richText',
      label: 'Beschreibung',
      admin: {
        description: 'Beschreibungstext unter der √úberschrift',
      },
    },
    // Spezielle Felder basierend auf Block-Typ
    // (siehe unten f√ºr Templates)
  ],
}
```

**FAQ Block Template:**

```typescript
// filepath: src/blocks/FAQ/{FAQBlockName}/config.ts
import type { Block } from 'payload'

export const {FAQBlockName}Block: Block = {
  slug: '{faqSlug}',
  labels: {
    singular: 'FAQ Sektion',
    plural: 'FAQ Sektionen',
  },
  fields: [
    {
      name: 'heading',
      type: 'text',
      label: '√úberschrift',
    },
    {
      name: 'description',
      type: 'textarea',
      label: 'Beschreibung',
    },
    {
      name: 'faqs',
      type: 'array',
      label: 'H√§ufig gestellte Fragen',
      minRows: 1,
      admin: {
        initCollapsed: true,
      },
      fields: [
        {
          name: 'question',
          type: 'text',
          label: 'Frage',
          required: true,
        },
        {
          name: 'answer',
          type: 'richText',
          label: 'Antwort',
          required: true,
        },
      ],
    },
  ],
}
```

**CTA Block Template:**

```typescript
// filepath: src/blocks/CTA/{CTABlockName}/config.ts
import type { Block } from 'payload'

export const {CTABlockName}Block: Block = {
  slug: '{ctaSlug}',
  labels: {
    singular: 'Call-to-Action',
    plural: 'Call-to-Actions',
  },
  fields: [
    {
      name: 'heading',
      type: 'text',
      label: '√úberschrift',
      required: true,
    },
    {
      name: 'subheading',
      type: 'textarea',
      label: 'Unter√ºberschrift',
    },
    {
      name: 'buttons',
      type: 'array',
      label: 'Buttons',
      maxRows: 2,
      fields: [
        {
          name: 'text',
          type: 'text',
          label: 'Button Text',
          required: true,
        },
        {
          name: 'link',
          type: 'group',
          fields: [
            {
              name: 'type',
              type: 'select',
              options: [
                { label: 'Interne Seite', value: 'page' },
                { label: 'Externe URL', value: 'url' },
              ],
            },
            {
              name: 'page',
              type: 'relationship',
              relationTo: 'pages',
              admin: {
                condition: (_, siblingData) => siblingData?.type === 'page',
              },
            },
            {
              name: 'url',
              type: 'text',
              admin: {
                condition: (_, siblingData) => siblingData?.type === 'url',
              },
            },
          ],
        },
        {
          name: 'variant',
          type: 'select',
          label: 'Button Stil',
          options: [
            { label: 'Standard', value: 'default' },
            { label: 'Outline', value: 'outline' },
            { label: 'Ghost', value: 'ghost' },
          ],
          defaultValue: 'default',
        },
      ],
    },
    {
      name: 'backgroundImage',
      type: 'upload',
      relationTo: 'media',
      label: 'Hintergrundbild',
      admin: {
        description: 'Optional: Hintergrundbild f√ºr den CTA Block',
      },
    },
  ],
}
```

**Contact Block Template:**

```typescript
// filepath: src/blocks/Contact/{ContactBlockName}/config.ts
import type { Block } from 'payload'

export const {ContactBlockName}Block: Block = {
  slug: '{contactSlug}',
  labels: {
    singular: 'Kontakt Sektion',
    plural: 'Kontakt Sektionen',
  },
  fields: [
    {
      name: 'heading',
      type: 'text',
      label: '√úberschrift',
    },
    {
      name: 'description',
      type: 'richText',
      label: 'Beschreibung',
    },
    {
      name: 'contactInfo',
      type: 'group',
      label: 'Kontaktinformationen',
      fields: [
        {
          name: 'email',
          type: 'email',
          label: 'E-Mail',
        },
        {
          name: 'phone',
          type: 'text',
          label: 'Telefon',
        },
        {
          name: 'address',
          type: 'textarea',
          label: 'Adresse',
        },
      ],
    },
    {
      name: 'showForm',
      type: 'checkbox',
      label: 'Formular anzeigen',
      defaultValue: true,
    },
  ],
}
```

**Gallery Block Template:**

```typescript
// filepath: src/blocks/Gallery/{GalleryBlockName}/config.ts
import type { Block } from 'payload'

export const {GalleryBlockName}Block: Block = {
  slug: '{gallerySlug}',
  labels: {
    singular: 'Galerie',
    plural: 'Galerien',
  },
  fields: [
    {
      name: 'heading',
      type: 'text',
      label: '√úberschrift',
    },
    {
      name: 'images',
      type: 'array',
      label: 'Bilder',
      minRows: 1,
      fields: [
        {
          name: 'image',
          type: 'upload',
          relationTo: 'media',
          label: 'Bild',
          required: true,
        },
        {
          name: 'caption',
          type: 'text',
          label: 'Bildunterschrift',
        },
      ],
    },
    {
      name: 'layout',
      type: 'select',
      label: 'Layout',
      options: [
        { label: 'Grid 2 Spalten', value: 'grid-2' },
        { label: 'Grid 3 Spalten', value: 'grid-3' },
        { label: 'Grid 4 Spalten', value: 'grid-4' },
        { label: 'Masonry', value: 'masonry' },
      ],
      defaultValue: 'grid-3',
    },
  ],
}
```

### 4. Block Components erstellen

```bash
echo "üìù Erstelle Block Komponenten..."

BUILD_CONFIG=$(cat .temp/build-config.json)
BLOCK_COUNT=$(echo $BUILD_CONFIG | jq '.components.blocks | length')

for i in $(seq 0 $(($BLOCK_COUNT - 1))); do
  BLOCK_NAME=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].name")
  BLOCK_CATEGORY=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].category")
  BLOCK_DIR="src/blocks/${BLOCK_CATEGORY}/${BLOCK_NAME}"
  
  mkdir -p "$BLOCK_DIR"
  
  echo "Creating $BLOCK_DIR/{Component.tsx, config.ts, index.ts}..."
done

echo "‚úÖ Block Komponenten Struktur erstellt"
```

F√ºr jeden Block:

```typescript
// filepath: src/blocks/{Category}/{BlockName}/Component.tsx
'use client'

import React from 'react'
import type { {BlockName}Block } from '@/payload-types'
import { Button } from '@/components/ui/button'
import { RichText } from '@/components/RichText'
import { Media } from '@/components/Media'
import { CMSLink } from '@/components/CMSLink'

interface {BlockName}Props {
  data: {BlockName}Block
}

export const {BlockName}: React.FC<{BlockName}Props> = ({ data }) => {
  // WICHTIG: Original Relume Code aus
  // .temp/relume-components/blocks/{Category}/{BlockName}.tsx
  // hier einf√ºgen und NUR Datenquelle √§ndern!
  
  return (
    <section className="px-[5%] py-16 md:py-24 lg:py-28">
      <div className="container">
        {data.heading && (
          <div className="mb-12 text-center md:mb-18 lg:mb-20">
            <h2 className="mb-5 text-5xl font-bold md:mb-6 md:text-7xl lg:text-8xl">
              {data.heading}
            </h2>
            {data.description && (
              <div className="md:text-md">
                <RichText content={data.description} />
              </div>
            )}
          </div>
        )}
        
        {/* Block-spezifischer Content hier */}
        {/* Original Relume JSX mit PayloadCMS data binding */}
        
        {data.buttons && data.buttons.length > 0 && (
          <div className="mt-10 flex flex-wrap justify-center gap-4">
            {data.buttons.map((button, index) => (
              <Button
                key={index}
                variant={button.variant}
                asChild
              >
                <CMSLink {...button.link}>
                  {button.text}
                </CMSLink>
              </Button>
            ))}
          </div>
        )}
      </div>
    </section>
  )
}
```

**FAQ Component Beispiel:**

```typescript
// filepath: src/blocks/FAQ/{FAQBlockName}/Component.tsx
'use client'

import React, { useState } from 'react'
import type { {FAQBlockName}Block } from '@/payload-types'
import { RichText } from '@/components/RichText'
import { ChevronDown } from 'lucide-react'

interface {FAQBlockName}Props {
  data: {FAQBlockName}Block
}

export const {FAQBlockName}: React.FC<{FAQBlockName}Props> = ({ data }) => {
  const [openIndex, setOpenIndex] = useState<number | null>(null)
  
  return (
    <section className="px-[5%] py-16 md:py-24 lg:py-28">
      <div className="container max-w-4xl">
        {data.heading && (
          <div className="mb-12 text-center">
            <h2 className="mb-4 text-4xl font-bold md:text-5xl">
              {data.heading}
            </h2>
            {data.description && (
              <p className="text-muted-foreground">
                {data.description}
              </p>
            )}
          </div>
        )}
        
        <div className="space-y-4">
          {data.faqs?.map((faq, index) => (
            <div
              key={index}
              className="border rounded-lg overflow-hidden"
            >
              <button
                onClick={() => setOpenIndex(openIndex === index ? null : index)}
                className="w-full px-6 py-4 text-left flex items-center justify-between hover:bg-muted transition-colors"
              >
                <span className="font-semibold">{faq.question}</span>
                <ChevronDown 
                  className={`transition-transform ${
                    openIndex === index ? 'rotate-180' : ''
                  }`}
                />
              </button>
              {openIndex === index && (
                <div className="px-6 py-4 border-t bg-muted/50">
                  <RichText content={faq.answer} />
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </section>
  )
}
```

### 5. Index Files erstellen

F√ºr jeden Block:

```typescript
// filepath: src/blocks/{Category}/{BlockName}/index.ts
export { {BlockName} } from './Component'
export { {BlockName}Block } from './config'
```

### 6. Block Renderer erstellen

```typescript
// filepath: src/blocks/index.tsx
'use client'

import React from 'react'

// Import all blocks aus build config
const buildConfig = JSON.parse(
  fs.readFileSync('.temp/build-config.json', 'utf-8')
);

${buildConfig.components.blocks.map(block => 
  `import { ${block.name} } from './${block.category}/${block.name}'`
).join('\n')}

// Export all block configs
${buildConfig.components.blocks.map(block => 
  `export { ${block.name}Block } from './${block.category}/${block.name}'`
).join('\n')}

export const BlockComponents = {
  ${buildConfig.components.blocks.map(block => {
    const slug = block.name.charAt(0).toLowerCase() + block.name.slice(1);
    return `${slug}: ${block.name}`;
  }).join(',\n  ')}
}

interface BlockRendererProps {
  blocks: any[]
}

export const BlockRenderer: React.FC<BlockRendererProps> = ({ blocks }) => {
  if (!blocks || blocks.length === 0) {
    return null
  }
  
  return (
    <>
      {blocks.map((block, index) => {
        const Component = BlockComponents[block.blockType]
        
        if (!Component) {
          console.warn(`Block type "${block.blockType}" not found`)
          return null
        }
        
        return <Component key={index} data={block} />
      })}
    </>
  )
}
```

### 7. Migrationen erstellen

```bash
echo "üìù Erstelle Migrationen f√ºr alle Blocks..."

BUILD_CONFIG=$(cat .temp/build-config.json)
BLOCK_COUNT=$(echo $BUILD_CONFIG | jq '.components.blocks | length')

for i in $(seq 0 $(($BLOCK_COUNT - 1))); do
  BLOCK_NAME=$(echo $BUILD_CONFIG | jq -r ".components.blocks[$i].name")
  BLOCK_SLUG=$(echo $BLOCK_NAME | tr '[:upper:]' '[:lower:]')
  
  echo "  Migration f√ºr ${BLOCK_NAME}..."
  npm run payload migrate:create -- --name "add-${BLOCK_SLUG}-block"
done

echo "üîÑ F√ºhre alle Migrationen aus..."
npm run payload migrate

if [ $? -eq 0 ]; then
  echo "‚úÖ Alle Migrationen erfolgreich ausgef√ºhrt"
else
  echo "‚ùå Migration fehlgeschlagen"
  exit 1
fi
```

### 8. Alle Blocks in payload.config.ts registrieren

```typescript
// filepath: src/payload.config.ts
// ...existing code...
import { Header } from './Header/config'
import { Footer } from './Footer/config'
import { HeroBlock } from './heroes/config'

// Import all block configs
${buildConfig.components.blocks.map(block => 
  `import { ${block.name}Block } from './blocks/${block.category}/${block.name}'`
).join('\n')}

export default buildConfig({
  // ...existing code...
  collections: [
    {
      slug: 'pages',
      // ...existing code...
      fields: [
        {
          name: 'layout',
          type: 'blocks',
          blocks: [
            HeroBlock,
            ${buildConfig.components.blocks.map(block => `${block.name}Block`).join(',\n            ')}
          ],
        },
      ],
    },
  ],
  globals: [
    Header,
    Footer,
  ],
})
```

### 9. Git Commit

```bash
BUILD_CONFIG=$(cat .temp/build-config.json)
BLOCK_COUNT=$(echo $BUILD_CONFIG | jq '.components.blocks | length')

# Gruppiere Blocks nach Kategorie
BLOCKS_BY_CATEGORY=$(cat .temp/analysis/blocks-analysis.json | \
  jq -r 'group_by(.category) | .[] | "\(.[0].category): \([.[].name] | join(", "))"')

git add src/blocks/
git add src/payload.config.ts
git add src/migrations/

git commit -m "feat(blocks): add ${BLOCK_COUNT} content blocks

Source: Various categories from cloned Relume repo

Blocks by category:
${BLOCKS_BY_CATEGORY}

Total: ${BLOCK_COUNT} blocks

Features:
‚úÖ Each block: Component.tsx, config.ts, index.ts
‚úÖ RichText, Media, CMSLink integration
‚úÖ German PayloadCMS labels
‚úÖ Original Relume designs preserved
‚úÖ All Tailwind classes maintained
‚úÖ ShadCN Button variants (default, outline, ghost)
‚úÖ Lucide icons for interactive elements
‚úÖ All migrations executed successfully
‚úÖ All blocks registered in payload.config.ts
‚úÖ BlockRenderer for dynamic rendering

No custom styles - pure ShadCN components!"

echo "‚úÖ Git Commit erstellt"
```

## Erfolgskriterien

- [ ] Alle Blocks erfolgreich aus Repo geladen
- [ ] Blocks korrekt nach Kategorie organisiert
- [ ] Alle Blocks analysiert
- [ ] Jeder Block hat vollst√§ndige Struktur (Component, config, index)
- [ ] Spezielle Block-Typen (FAQ, CTA, Contact, Gallery) korrekt konfiguriert
- [ ] RichText, Media, CMSLink korrekt verwendet
- [ ] Nur ShadCN Button Variants verwendet (keine Custom-Styles!)
- [ ] Alle Blocks in payload.config.ts registriert
- [ ] Alle Migrationen erfolgreich ausgef√ºhrt
- [ ] BlockRenderer funktioniert
- [ ] Git Commit erstellt
- [ ] Relume Designs exakt beibehalten

## N√§chster Schritt
`.cursor/commands/05-finalize.mdc`